# TW Stocker

æ¯å¤©æ›´æ–°çš„å°è‚¡æ­·å²è³‡æ–™åº«ï¼Œè¨ˆç®—æŠ€è¡“æŒ‡æ¨™ï¼Œå›æ¸¬ç„¶å¾Œæ¨è–¦è‚¡ç¥¨ã€‚  

https://voidful.github.io/tw_stocker/stock_report.html

## âš ï¸ ç’°å¢ƒè¦æ±‚

**Python ç‰ˆæœ¬ï¼š3.12 (æ¨è–¦) æˆ– 3.13**

æœ¬å°ˆæ¡ˆä¾è³´ `fta` å¥—ä»¶ï¼Œå…¶å…§éƒ¨ä¾è³´ `numba` (ç‰ˆæœ¬é™åˆ¶ç‚º 0.61.x)ã€‚ç”±æ–¼ numba å®˜æ–¹ç›®å‰å°šæœªæ”¯æ´ **Python 3.14**ï¼Œè‹¥ä½¿ç”¨ Python 3.14 å‰‡å®‰è£æœƒå¤±æ•—ã€‚è«‹ç¢ºä¿ä½ çš„ Python ç’°å¢ƒåœ¨ **3.12 æˆ– 3.13**ã€‚

å¯é€éä»¥ä¸‹æ–¹å¼æª¢æŸ¥ Python ç‰ˆæœ¬ï¼š

```bash
python3 --version
```

è‹¥ç‰ˆæœ¬éæ–°ï¼Œå»ºè­°ä½¿ç”¨è™›æ“¬ç’°å¢ƒç®¡ç†å·¥å…·ï¼ˆå¦‚ `pyenv` æˆ– Condaï¼‰é™ç´šè‡³æ”¯æ´çš„ç‰ˆæœ¬ã€‚

### å¿«é€Ÿç’°å¢ƒè¨­å®šï¼ˆmacOS / Homebrewï¼‰

è‹¥ä½ å°šæœªå®‰è£ Python 3.12ï¼Œå¯é€é Homebrew å®‰è£ï¼š

```bash
brew install python@3.12
```

å®‰è£å®Œæˆå¾Œï¼Œå»ºç«‹è™›æ“¬ç’°å¢ƒä¸¦å•Ÿå‹•ï¼š

```bash
python3.12 -m venv .venv
source .venv/bin/activate
```

å‡ç´š pipã€setuptools èˆ‡ wheelï¼ˆç¢ºä¿å®‰è£å·¥å…·ç‚ºæœ€æ–°ï¼‰ï¼š

```bash
pip install --upgrade pip setuptools wheel
```

æœ€å¾Œå®‰è£å°ˆæ¡ˆä¾è³´ï¼š

```bash
pip install -r requirements.txt
```

å®Œæˆå¾Œï¼Œä½ å¯ä»¥ç›´æ¥åŸ·è¡Œå°ˆæ¡ˆæŒ‡ä»¤ï¼ˆè¦‹ä¸‹æ–¹ **main.py æŒ‡ä»¤ç¯„ä¾‹**ï¼‰ã€‚

> **é‡è¦æé†’**ï¼šå®‰è£å®Œæˆå¾Œï¼Œæ¯æ¬¡åŸ·è¡Œå°ˆæ¡ˆæŒ‡ä»¤å‰å‹™å¿…å…ˆå•Ÿå‹•è™›æ“¬ç’°å¢ƒï¼š`source .venv/bin/activate`ã€‚è‹¥æœªå•Ÿå‹•è™›æ“¬ç’°å¢ƒè€Œç›´æ¥åŸ·è¡Œ `python3 main.py ...`ï¼Œå¯èƒ½æœƒå› ç‚ºä¾è³´ç¼ºå¤±è€Œå‡ºéŒ¯ã€‚

## æª”æ¡ˆèªªæ˜ï¼ˆå„ `.py` çš„ç”¨é€”ï¼‰

- `main.py`: å°ˆæ¡ˆçš„ç°¡æ˜“ CLI å…¥å£ï¼Œæä¾›å­å‘½ä»¤ `download`, `update`, `recommend`, `example`ï¼Œç”¨ä¾†åˆ†åˆ¥åŸ·è¡Œè³‡æ–™ä¸‹è¼‰ã€æ›´æ–°ã€å ±è¡¨ç”¢ç”Ÿèˆ‡ç¤ºç¯„è…³æœ¬ã€‚
- `init.py`: è³‡æ–™ä¸‹è¼‰å™¨ï¼ˆè¼ƒåƒä¸€æ¬¡æ€§è…³æœ¬ï¼‰ã€‚å°Â twstock.codesÂ ä¸­çš„ä¸Šå¸‚è‚¡ç¥¨/ETFï¼Œä½¿ç”¨Â vectorbt.YFData.downloadÂ ä»¥ 5 åˆ†é˜é–“éš”ä¸‹è¼‰è¿‘ N å¤©ï¼ˆé è¨­ 59 å¤©ï¼‰ä¹‹è³‡æ–™ä¸¦å­˜æˆÂ ./data/{code}.csvã€‚
- `update.py`: CSV æ›´æ–°å™¨ã€‚å°æ¯æª”è‚¡ç¥¨å˜—è©¦å¾ä¸Šæ¬¡ç´€éŒ„æ™‚é–“é–‹å§‹ä¸‹è¼‰æ–°å¢çš„ 5 åˆ†é˜è³‡æ–™ï¼ˆæœƒæ¸…ç†æ ¼å¼æœ‰å•é¡Œçš„ CSV è¡Œä¸¦ append æ–°è³‡æ–™ï¼‰ï¼Œä¸¦åœ¨æ¯æ¬¡ä¸‹è¼‰å¾Œæš«åœä»¥é¿å… rate limitã€‚åŒ…å«éŒ¯èª¤è™•ç†èˆ‡æ—¥èªŒè¼¸å‡ºã€‚
- `recommend.py`: æ¨è–¦ / å ±è¡¨ç”¢ç”Ÿå™¨ã€‚è®€å–è‚¡ç¥¨ CSVï¼ˆä¾†è‡ªÂ nlp2.get_files_from_dir("data")ï¼‰ï¼Œæ¨™æº–åŒ–æ¬„ä½ï¼ˆopen/high/low/close/volumeï¼‰ï¼Œå‘¼å«Â strategy.grid.tradeÂ å¾—åˆ°è²·è³£è¨Šè™Ÿèˆ‡ç¸¾æ•ˆï¼Œåˆ¤æ–·è¿‘æœŸæ˜¯å¦æ‡‰è²·/è³£ä¸¦å½™æ•´æˆä¸€å¼µ HTML å ±è¡¨ï¼ˆç”¨ Jinja2 æ¨¡æ¿Â stock_report_template.htmlï¼‰ï¼Œæœ€å¾Œå¯«å‡ºÂ stock_report.htmlã€‚
- `example.py`: ç¯„ä¾‹/æ¼”ç¤ºè…³æœ¬ã€‚è®€å–é ç«¯ CSVï¼ˆç¤ºä¾‹ç‚ºÂ 4967.csvï¼‰ï¼Œç”¨Â ftaÂ è¨ˆç®—æŠ€è¡“æŒ‡æ¨™ï¼Œå‘¼å«Â strategy.just_keep_buying_with_technicals.tradeÂ ç”¢ç”Ÿäº¤æ˜“è¨Šè™Ÿï¼Œç„¶å¾Œç”¨Â vectorbt.Portfolio.from_signalsÂ å»ºç«‹æŠ•è³‡çµ„åˆä¸¦åˆ—å°/ç¹ªåœ–çµæœã€‚
- `strategy/grid.py`: ç­–ç•¥æ¨¡çµ„ â€” RSI + å¸ƒæ—å¸¶æ ¼å±€ç­–ç•¥ã€‚è‡ªè¡Œè¨ˆç®— RSIã€EMAã€20 æ—¥å‡ã€ä¸Šä¸‹å¸ƒæ—å¸¶ï¼›ç•¶ RSI éä½ä¸”è·Œç ´ä¸‹å¸¶æ™‚è²·å…¥ï¼Œç•¶ RSI éé«˜ä¸”æ¼²ç ´ä¸Šå¸¶æ™‚è³£å‡ºã€‚å›å‚³è²·/è³£ç´¢å¼•ã€entry/exit å¸ƒæ—ã€ç¸½ç²åˆ©èˆ‡æŠ•è³‡å ±é…¬ç‡ã€‚
- `strategy/dynamic_delay.py`: ç­–ç•¥æ¨¡çµ„ â€” å»¶é²åˆ‡æ›å‹ï¼ˆstate-basedï¼‰äº¤æ˜“æ¨¡æ“¬ã€‚ä»¥äº¤æ›¿è²·/è³£ç‹€æ…‹é‹ä½œï¼Œåªæœ‰ç•¶åƒ¹æ ¼è®Šå‹•æ»¿è¶³ã€Œå»¶é²æ¬¡æ•¸ï¼ˆdelayï¼‰ã€å¾Œæ‰åŸ·è¡Œè²·/è³£ã€‚å›å‚³äº¤æ˜“äº‹ä»¶èˆ‡ç¸¾æ•ˆã€‚
- `strategy/just_keep_buying_with_technicals.py`: ç­–ç•¥æ¨¡çµ„ â€” æŒçºŒå®šæœŸè²·å…¥ï¼ˆå¸¶æŠ€è¡“æŒ‡æ¨™éæ¿¾ï¼‰ã€‚éœ€è¦è³‡æ–™ä¸­å·²å«Â adx,rsi,atrÂ ç­‰æŒ‡æ¨™ï¼ˆæˆ–å…ˆå‰ç”¨Â ftaÂ è¨ˆç®—ï¼‰ï¼Œä¾ ADX/RSI/ATR åˆ¤æ–·è¶¨å‹¢ã€å‹•é‡èˆ‡æ³¢å‹•ä¸¦åœ¨å›ºå®šé–“éš”æŠ•å…¥è³‡é‡‘ï¼›å›å‚³è²·è³£äº‹ä»¶èˆ‡ç¸¾æ•ˆã€‚

å¦å¤–é‚„æœ‰æ–‡ä»¶ `STRATEGY_INTERFACE.md`ï¼Œåˆ—å‡ºå„ç­–ç•¥å‡½å¼çš„è¼¸å…¥æ¬„ä½éœ€æ±‚èˆ‡å›å‚³æ ¼å¼ï¼Œæ–¹ä¾¿æ•´åˆèˆ‡å‘¼å«ã€‚

## main.py æŒ‡ä»¤ç¯„ä¾‹ï¼ˆå¯¦éš›å¯ä½¿ç”¨çš„æŒ‡ä»¤ï¼‰

ä»¥ä¸‹ç¯„ä¾‹å‡è¨­ä½ åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼ˆæœ‰ `main.py` çš„ç›®éŒ„ï¼‰åŸ·è¡Œå‘½ä»¤ã€‚è‹¥ä½¿ç”¨ virtualenvï¼Œå…ˆå•Ÿå‹•ä½ çš„ç’°å¢ƒä¸¦å®‰è£ä¾è³´ã€‚

### å¿«é€ŸåŸ·è¡Œï¼šä¸€éµæ›´æ–°èˆ‡å ±è¡¨ç”¢ç”Ÿ

è‹¥è¦ä¸€æ¬¡æ€§åŸ·è¡Œã€Œæ›´æ–°è³‡æ–™ â†’ ç”¢ç”Ÿå ±è¡¨ã€ï¼ˆæ¨è–¦ç”¨æ³•ï¼‰ï¼Œç›´æ¥åŸ·è¡Œï¼š

```bash
./run.sh
```

æ­¤è…³æœ¬æœƒè‡ªå‹•ï¼š
1. æª¢æŸ¥è™›æ“¬ç’°å¢ƒæ˜¯å¦å­˜åœ¨
2. å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
3. åŸ·è¡Œ `update` ä¸‹è¼‰æœ€æ–°è³‡æ–™
4. åŸ·è¡Œ `recommend` ç”¢ç”Ÿæ¨è–¦å ±è¡¨è‡³ `stock_report.html`

è‹¥éœ€å®Œæ•´é‡æ–°ä¸‹è¼‰æ‰€æœ‰è‚¡ç¥¨è³‡æ–™ï¼Œç·¨è¼¯ `run.sh` ä¸¦å–æ¶ˆè¨»è§£ `download` å€å¡Šã€‚

### å„åˆ¥åŸ·è¡ŒæŒ‡ä»¤

- ä¸‹è¼‰æ‰€æœ‰è‚¡ç¥¨è³‡æ–™ï¼ˆå¯èƒ½è€—æ™‚å¾ˆä¹…ï¼Œè«‹æ–Ÿé…Œä½¿ç”¨ï¼‰ï¼š

```bash
source .venv/bin/activate
python3 main.py download
```

- æ›´æ–°è³‡æ–™ï¼ˆåªä¸‹è¼‰è‡ªä¸Šæ¬¡è¨˜éŒ„å¾Œçš„æ–°è³‡æ–™ï¼‰ï¼š

```bash
source .venv/bin/activate
python3 main.py update
```

- ç”¢ç”Ÿæ¨è–¦å ±è¡¨ï¼ˆæœƒæƒæ `data/` ä¸‹çš„ CSVï¼Œè¼¸å‡º `stock_report.html`ï¼‰ï¼š

```bash
source .venv/bin/activate
python3 main.py recommend
```

- åŸ·è¡Œç¤ºç¯„è…³æœ¬ï¼ˆç¤ºç¯„å¦‚ä½•è¨ˆç®—æŠ€è¡“æŒ‡æ¨™ä¸¦åšå›æ¸¬ï¼‰ï¼š

```bash
source .venv/bin/activate
python3 main.py example
```

### Web å‰ç«¯ç•Œé¢ï¼ˆFlaskï¼‰

è‹¥ä¸æƒ³åœ¨çµ‚ç«¯åŸ·è¡ŒæŒ‡ä»¤ï¼Œå¯ä½¿ç”¨ Flask web å‰ç«¯æŸ¥çœ‹å ±è¡¨ä¸¦è§¸ç™¼æ›´æ–°ï¼š

```bash
source .venv/bin/activate
python3 webapp.py
```

å•Ÿå‹•å¾Œï¼Œåœ¨ç€è¦½å™¨é–‹å•Ÿï¼š

```
http://localhost:5000
```

å‰ç«¯åŠŸèƒ½ï¼š
- **å³æ™‚é¡¯ç¤ºæœ€æ–°å ±è¡¨**ï¼šé¦–æ¬¡é–‹å•Ÿæ™‚ç›´æ¥å±•ç¤º `stock_report.html`
- **æ›´æ–°æŒ‰éˆ•**ï¼šæŒ‰ä¸‹ã€ŒğŸ“Š æ›´æ–°ã€å¾Œæœƒåœ¨èƒŒæ™¯åŸ·è¡Œ `run.sh`ï¼ˆæ›´æ–°è³‡æ–™ â†’ ç”¢ç”Ÿå ±è¡¨ï¼‰
- **å³æ™‚æ—¥èªŒ**ï¼šæ›´æ–°æœŸé–“æœƒé¡¯ç¤ºåŸ·è¡Œæ—¥èªŒï¼Œå®Œæˆå¾Œè‡ªå‹•é‡æ–°è¼‰å…¥å ±è¡¨

#### GitHub Pages vs Flask æ–¹å¼æ¯”è¼ƒ

| é …ç›® | GitHub Pagesï¼ˆç·šä¸Šéœæ…‹ç‰ˆï¼‰ | Flaskï¼ˆæœ¬æ©Ÿå‹•æ…‹ç‰ˆï¼‰ |
|------|---------------------------|-----------------|
| è¨ªå•æ–¹å¼ | https://voidful.github.io/tw_stocker/stock_report.html | http://localhost:5000ï¼ˆæœ¬æ©Ÿï¼‰ |
| éƒ¨ç½²ä½ç½® | GitHub ç·šä¸Š | æœ¬åœ°/å…§ç¶²ä¼ºæœå™¨ |
| æ›´æ–°æ–¹å¼ | éœ€æ‰‹å‹• push æˆ– CI/CD è‡ªå‹•åŒ– | é»æ“Šç¶²é æŒ‰éˆ•ç«‹å³æ›´æ–° |
| äº’å‹•æ€§ | ç„¡ï¼ˆç´”éœæ…‹ HTMLï¼‰ | æœ‰ï¼ˆæŒ‰éˆ•ã€æ—¥èªŒã€è‡ªå‹•é‡è¼‰ï¼‰ |
| é©ç”¨å ´æ™¯ | å…¬é–‹åˆ†äº«ã€å®šæœŸè‡ªå‹•æ›´æ–° | å€‹äººé–‹ç™¼ã€éš¨æ™‚æŸ¥çœ‹æ¸¬è©¦ |

**å»ºè­°ç”¨æ³•**
- **æ—¥å¸¸é–‹ç™¼æ¸¬è©¦**ï¼šä½¿ç”¨ Flask æ–¹å¼ï¼Œæ–¹ä¾¿å¿«é€Ÿè¿­ä»£èˆ‡æª¢è¦–çµæœ
- **å°å¤–åˆ†äº«å ±è¡¨**ï¼šå®šæœŸå°‡æœ€æ–°çš„ `stock_report.html` push åˆ° GitHub Pagesï¼Œä¾›ä»–äººæŸ¥é–±

å°æç¤ºï¼š
- è‹¥è¦åœ¨èƒŒæ™¯åŸ·è¡Œï¼ˆLinux / macOSï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ `nohup` æˆ– `&`ï¼š

```bash
# èƒŒæ™¯åŸ·è¡Œï¼Œä¸¦æŠŠè¼¸å‡ºå¯«å…¥ log
nohup python3 main.py update > update.log 2>&1 &
```

- è‹¥é‡åˆ°å¥—ä»¶ç¼ºå¤±æˆ–åŒ¯å…¥éŒ¯èª¤ï¼Œå…ˆç¢ºèªå®‰è£ï¼š

```bash
source .venv/bin/activate
pip install -r requirements.txt
```

> **å®‰å…¨æé†’**ï¼šFlask å‰ç«¯æä¾›äº†åŸ·è¡Œ `run.sh` çš„åŠŸèƒ½ã€‚è«‹ä¸è¦ç›´æ¥åœ¨å…¬é–‹ç¶²è·¯æš´éœ²æ­¤æœå‹™ï¼Œé™¤éåŠ å…¥èªè­‰é˜²è­·ï¼ˆä¾‹å¦‚åå‘ä»£ç†ã€IP é™åˆ¶ç­‰ï¼‰ã€‚

## ä½¿ç”¨æ–¹å¼ï¼Œä»¥2330ç‚ºä¾‹ï¼Œå¯ä»¥æ›æˆè‡ªå·±éœ€è¦çš„è‚¡ç¥¨

```python
import pandas as pd

url="https://raw.githubusercontent.com/voidful/tw_stocker/main/data/2330.csv"
pd.read_csv(url)
```

## è³‡æ–™ä¾†æº

Yahoo financeï¼Œæ¯éš”5åˆ†é˜çš„å…­åå¤©å…§è³‡æ–™ï¼Œæœƒç”¨github actionæŒçºŒæ›´æ–°ã€‚


## æŠ½å–æŠ€è¡“æŒ‡æ¨™
1. `pip install fta`
2. 
```python
import pandas as pd
import fta
url = "https://raw.githubusercontent.com/voidful/tw_stocker/main/data/2330.csv"
df = pd.read_csv(url, index_col='Datetime')

ta = fta.TA_Features()
df_full = ta.get_all_indicators(df)
print(df_full)
```

## æ¨¡æ“¬äº¤æ˜“
åƒè€ƒ`strategy/dynamic_delay`ä½œç‚ºæˆ‘å€‘äº¤æ˜“çš„ç­–ç•¥  
```python
import pandas as pd
import fta
from strategy.dynamic_delay import trade

url = "https://raw.githubusercontent.com/voidful/tw_stocker/main/data/2330.csv"
df = pd.read_csv(url, index_col='Datetime')


ta = fta.TA_Features()
df_full = ta.get_all_indicators(df)

PARAMETER = {
    "delay": 15,
    "initial_money": 10000,
    "max_buy": 10,
    "max_sell": 10,
}

states_buy, states_sell, states_entry, states_exit, total_gains, invest = trade(df_full, **PARAMETER)
```
#### çµæœ
![image](./img/trade_record.png)

### äº¤æ˜“åœ–è¡¨
```python
from matplotlib import pyplot as plt
import pandas as pd
import fta
from strategy.dynamic_delay import trade

url = "https://raw.githubusercontent.com/voidful/tw_stocker/main/data/2330.csv"
df = pd.read_csv(url, index_col='Datetime')


ta = fta.TA_Features()
df_full = ta.get_all_indicators(df)

PARAMETER = {
    "delay": 15,
    "initial_money": 10000,
    "max_buy": 10,
    "max_sell": 10,
}

states_buy, states_sell, states_entry, states_exit, total_gains, invest = trade(df_full, **PARAMETER)

close = df_full['close']
fig = plt.figure(figsize = (15,5))
plt.plot(close, color='r', lw=2.)
plt.plot(close, '^', markersize=10, color='m', label = 'buying signal', markevery = states_buy)
plt.plot(close, 'v', markersize=10, color='k', label = 'selling signal', markevery = states_sell)
plt.legend()
plt.show()
```
#### çµæœ
![image](./img/trade_graph.png)

### å›æ¸¬
```python
import vectorbt as vbt
import pandas as pd
import numpy as np
import fta
from strategy.dynamic_delay import trade

url = "https://raw.githubusercontent.com/voidful/tw_stocker/main/data/2330.csv"
df = pd.read_csv(url, index_col='Datetime')


ta = fta.TA_Features()
df_full = ta.get_all_indicators(df)

PARAMETER = {
    "delay": 15,
    "initial_money": 10000,
    "max_buy": 10,
    "max_sell": 10,
}

states_buy, states_sell, states_entry, states_exit, total_gains, invest = trade(df_full, **PARAMETER)

fees = 0 # å‡è¨­äº¤æ˜“è²»ç”¨ç‚º 0
portfolio_kwargs = dict(size=np.inf, fees=float(fees), freq='5m')
portfolio = vbt.Portfolio.from_signals(df_full['close'], states_entry, states_exit, **portfolio_kwargs)
print(portfolio.stats())
portfolio.plot().show()
```

## äº¤æ˜“ç­–ç•¥è©³è§£

å°ˆæ¡ˆå…§å«ä¸‰å€‹ä¸åŒçš„äº¤æ˜“ç­–ç•¥æ¨¡çµ„ï¼Œå„è‡ªæ¡ç”¨ä¸åŒçš„é‚è¼¯èˆ‡åƒæ•¸èª¿æ•´æ–¹å¼ï¼š

### 1. **Grid Strategyï¼ˆç¶²æ ¼äº¤æ˜“ç­–ç•¥ï¼‰** â€” `strategy/grid.py`

**é‚è¼¯æ¦‚è¿°ï¼š**
- åŸºæ–¼æŠ€è¡“æŒ‡æ¨™ï¼ˆRSI + å¸ƒæ—å¸¶ï¼‰é€²è¡Œè²·è³£æ±ºç­–
- è¨ˆç®— RSIï¼ˆç›¸å°å¼·å¼±æŒ‡æ•¸ï¼‰ã€EMAï¼ˆæŒ‡æ•¸ç§»å‹•å¹³å‡ï¼‰ã€å¸ƒæ—å¸¶ï¼ˆ20æ—¥å‡ç·š Â± 2å€æ¨™æº–å·®ï¼‰

**é¸è‚¡åˆ¤æ–·ï¼š**
```
è²·å…¥æ¢ä»¶ï¼šRSI < 30 (éåº¦è³£è¶…) AND åƒ¹æ ¼ < ä¸‹å¸ƒæ—å¸¶
è³£å‡ºæ¢ä»¶ï¼šRSI > 70 (éåº¦è²·è¶…) AND åƒ¹æ ¼ > ä¸Šå¸ƒæ—å¸¶
```

**å¯¦ä½œæ–¹å¼ï¼š**
- é€ç­†æƒææ­·å²è³‡æ–™ï¼Œæª¢æŸ¥æ˜¯å¦æ»¿è¶³è²·è³£æ¢ä»¶
- æ¯æ¬¡è²·è³£é™åˆ¶ç‚º 1 å–®ä½
- è³‡é‡‘ç®¡ç†ï¼šæœ‰è¶³å¤ ç¾é‡‘æ‰è²·å…¥ï¼Œæœ‰æŒè‚¡æ‰è³£å‡º

**åƒæ•¸èª¿æ•´ï¼š**
- `rsi_period`ï¼šRSI è¨ˆç®—é€±æœŸï¼ˆé è¨­ 14ï¼‰
- `low_rsi`ã€`high_rsi`ï¼šRSI éåº¦è³£è¶…èˆ‡è²·è¶…é–¾å€¼ï¼ˆé è¨­ 30 / 70ï¼‰
- `ema_period`ï¼šEMA è¨ˆç®—é€±æœŸï¼ˆé è¨­ 26ï¼‰

**é©ç”¨å ´æ™¯ï¼š** éœ‡ç›ªç›¤æ•´è¡Œæƒ…ï¼Œè¿½æ±‚ä½è²·é«˜è³£

---

### 2. **Dynamic Delay Strategyï¼ˆå»¶é²åˆ‡æ›ç­–ç•¥ï¼‰** â€” `strategy/dynamic_delay.py`

**é‚è¼¯æ¦‚è¿°ï¼š**
- é€éè²·/è³£ç‹€æ…‹äº¤æ›¿é€²è¡Œäº¤æ˜“
- ä¾æ“šã€Œå»¶é²è¨ˆæ•¸å™¨ã€çš„è§¸ç™¼ä¾†åŸ·è¡Œè²·è³£æ“ä½œ
- èˆ‡åƒ¹æ ¼çµ•å°å€¼ç„¡é—œï¼Œåªé—œæ³¨åƒ¹æ ¼ä¸Šä¸‹è®Šå‹•è¶¨å‹¢

**é¸è‚¡åˆ¤æ–·ï¼š**
```
ç‹€æ…‹ = 1ï¼ˆè²·æ¨¡å¼ï¼‰ï¼šç•¶å‰åƒ¹æ ¼ < å‰ä¸€å€‹åƒ¹æ ¼ â†’ è¨ˆæ•¸å™¨ç´¯åŠ 
  â†’ è¨ˆæ•¸å™¨é”åˆ°å»¶é²æ¬¡æ•¸ â†’ åŸ·è¡Œè²·å…¥ï¼Œé‡ç½®è¨ˆæ•¸å™¨ï¼Œåˆ‡æ›åˆ°è³£æ¨¡å¼

ç‹€æ…‹ = 0ï¼ˆè³£æ¨¡å¼ï¼‰ï¼šç•¶å‰åƒ¹æ ¼ > å‰ä¸€å€‹åƒ¹æ ¼ â†’ è¨ˆæ•¸å™¨ç´¯åŠ 
  â†’ è¨ˆæ•¸å™¨é”åˆ°å»¶é²æ¬¡æ•¸ â†’ åŸ·è¡Œè³£å‡ºï¼Œé‡ç½®è¨ˆæ•¸å™¨ï¼Œåˆ‡æ›åˆ°è²·æ¨¡å¼
```

**å¯¦ä½œæ–¹å¼ï¼š**
- é€æ ¹ K ç·šæƒæï¼Œç›£æ§åƒ¹æ ¼è®Šå‹•æ–¹å‘
- è¨ˆæ•¸å™¨è¶…é `delay` é–€æª»æ™‚æ‰åŸ·è¡Œäº¤æ˜“
- è³‡é‡‘ç®¡ç†ï¼šé™åˆ¶å–®æ¬¡è²·å…¥é‡ï¼ˆ`max_buy`ï¼‰ã€å–®æ¬¡è³£å‡ºé‡ï¼ˆ`max_sell`ï¼‰

**åƒæ•¸èª¿æ•´ï¼š**
- `delay`ï¼šéœ€è¦å¤šå°‘å€‹åå‘è®Šå‹•å¾Œæ‰åŸ·è¡Œäº¤æ˜“ï¼ˆé è¨­ 5ï¼‰
- `initial_state`ï¼šåˆå§‹ç‹€æ…‹ï¼ˆ1=è²·ï¼Œ0=è³£ï¼›é è¨­ 1ï¼‰
- `max_buy`ã€`max_sell`ï¼šå–®æ¬¡äº¤æ˜“æœ€å¤§æ•¸é‡ï¼ˆé è¨­å„ 1ï¼‰

**é©ç”¨å ´æ™¯ï¼š** è¿½è¹¤è¶¨å‹¢è®ŠåŒ–ï¼Œè‡ªå‹•é€²å‡ºå ´

---

### 3. **Just Keep Buying with Technicalsï¼ˆæŠ€è¡“æŒ‡æ¨™è²·é€²ç­–ç•¥ï¼‰** â€” `strategy/just_keep_buying_with_technicals.py`

**é‚è¼¯æ¦‚è¿°ï¼š**
- æ ¸å¿ƒç­–ç•¥æ˜¯ã€Œå®šæœŸè²·é€²ã€ï¼ˆå®šæŠ•ï¼‰ï¼Œä½†åŠ å…¥æŠ€è¡“æŒ‡æ¨™éæ¿¾
- ä¾æ“š ADXï¼ˆè¶¨å‹¢å¼·åº¦ï¼‰ã€RSIï¼ˆå‹•é‡ï¼‰ã€ATRï¼ˆæ³¢å‹•ç‡ï¼‰ä¸‰å€‹æŒ‡æ¨™é€²è¡Œæ±ºç­–

**é¸è‚¡åˆ¤æ–·ï¼š**
```
é€å€‹å›ºå®šé€±æœŸæª¢æŸ¥ï¼ˆæ¯ investment_interval æ ¹ K ç·šï¼‰ï¼š
  è¶¨å‹¢åˆ¤å®šï¼šADX > adx_threshold â†’ ä¸Šå‡è¶¨å‹¢
  å‹•é‡åˆ¤å®šï¼šRSI < 45 â†’ è¶…è³£ï¼ŒRSI > 65 â†’ è¶…è²·ï¼Œå¦å‰‡ä¸­æ€§
  æ³¢å‹•åˆ¤å®šï¼šATR > atr_threshold â†’ é«˜æ³¢å‹•ï¼Œå¦å‰‡ä½æ³¢å‹•

è²·å…¥æ¢ä»¶ï¼ˆåŒæ™‚æ»¿è¶³ï¼‰ï¼š
  â€¢ è¶¨å‹¢ = ä¸Šå‡
  â€¢ å‹•é‡ â‰  è¶…è²·
  â€¢ æ³¢å‹• â‰  é«˜

è²·å…¥é‡‘é¡ï¼š
  â€¢ æ­£å¸¸æƒ…æ³ï¼šinitial_money Ã— 1
  â€¢ è¶…è³£æ™‚ï¼šinitial_money Ã— 1.5ï¼ˆåŠ å¼·è²·é€²ï¼‰

æˆæœ¬èª¿æ•´ï¼š
  â€¢ æ‰£é™¤æ‰‹çºŒè²»ï¼šinvestment_amount Ã— fee_rateï¼ˆé è¨­ 0.1425%ï¼‰
  â€¢ åŠ å…¥æ»‘é»æå¤±ï¼šprice Ã— (1 + slippage)ï¼ˆé è¨­ 0.05%ï¼‰
```

**å¯¦ä½œæ–¹å¼ï¼š**
- é€æ ¹ K ç·šæª¢æŸ¥æ˜¯å¦ç¬¦åˆè²·å…¥æ¢ä»¶
- è‹¥ç¬¦åˆï¼Œå‰‡è²·å…¥ä¸¦ç´¯ç©æŒè‚¡ï¼ˆä¸è¨­å®šè³£å‡ºé»ï¼‰
- æœ€å¾Œç”¨ç¾åƒ¹è¨ˆç®—ç¸½è³‡ç”¢ï¼ˆæŒè‚¡ + ç¾é‡‘ï¼‰

**åƒæ•¸èª¿æ•´ï¼š**
- `adx_threshold`ï¼šADX åˆ¤å®šè¶¨å‹¢çš„æœ€ä½å€¼ï¼ˆé è¨­ 10ï¼‰
- `rsi_lower_bound`ã€`rsi_upper_bound`ï¼šRSI è¶…è³£ / è¶…è²·é–¾å€¼ï¼ˆé è¨­ 45 / 65ï¼‰
- `atr_threshold`ï¼šATR åˆ¤å®šé«˜æ³¢å‹•çš„é–¾å€¼ï¼ˆé è¨­ 0.1ï¼‰
- `investment_interval`ï¼šæ¯éš”å¤šå°‘æ ¹ K ç·šæª¢æŸ¥ä¸€æ¬¡è²·å…¥ï¼ˆé è¨­ 1ï¼‰
- `fee_rate`ã€`slippage`ï¼šæ‰‹çºŒè²»èˆ‡æ»‘é»ï¼ˆé è¨­ 0.1425% / 0.05%ï¼‰

**é©ç”¨å ´æ™¯ï¼š** é•·æœŸå®šæŠ•ï¼Œçœ‹å¤šå¸‚å ´ï¼›ä½æˆæœ¬è²·é€²å„ªè³ªè‚¡ç¥¨

---

### ç­–ç•¥å°æ¯”ç¸½è¡¨

| é …ç›® | Grid | Dynamic Delay | Keep Buying |
|------|------|---------------|------------|
| **æ ¸å¿ƒé‚è¼¯** | åå‘é«˜æ‹‹ä½å¸ | è¿½è¹¤è¶¨å‹¢åè½‰ | å®šæœŸè²·é€²ï¼ˆçœ‹å¤šï¼‰ |
| **ä¸»è¦æŒ‡æ¨™** | RSI + å¸ƒæ—å¸¶ | åƒ¹æ ¼è®Šå‹•æ–¹å‘ | ADX + RSI + ATR |
| **è²·å…¥æ¢ä»¶** | éåº¦è³£è¶… + ç ´ä½å¸¶ | ä¸‹è·Œç¢ºèªå¾Œ | ä¸Šå‡è¶¨å‹¢ + éè¶…è²· + ä½æ³¢å‹• |
| **è³£å‡ºç­–ç•¥** | éåº¦è²·è¶… + ç ´é«˜å¸¶ | ä¸Šå‡ç¢ºèªå¾Œ | ä¸ä¸»å‹•è³£å‡ºï¼ˆæŒè‚¡ï¼‰ |
| **é©ç”¨è¡Œæƒ…** | éœ‡ç›ªç›¤ | è¶¨å‹¢è½‰æŠ˜ | çœ‹æ¼²è¡Œæƒ… |
| **é¢¨éšªç‰¹æ€§** | æŒ¯ç›ªæå¤±é¢¨éšª | è¿½é«˜æ®ºä½é¢¨éšª | å–®é‚Šä¸‹è·Œé¢¨éšª |
| **è³‡é‡‘æ•ˆç‡** | ä¸­ç­‰ | ä½ï¼ˆé »ç¹äº¤æ˜“ï¼‰ | é«˜ï¼ˆæŒè‚¡æ¯”ä¾‹é«˜ï¼‰ |

---

### å¦‚ä½•é¸æ“‡ç­–ç•¥

1. **Gridï¼ˆç¶²æ ¼ç­–ç•¥ï¼‰**ï¼šé©åˆåœ¨æŒ‡å®šåƒ¹æ ¼å€é–“å…§åè¦†äº¤æ˜“ï¼Œæ‡‰ç”¨æ–¼éœ‡ç›ªç›¤æ•´çš„å€‹è‚¡
2. **Dynamic Delayï¼ˆå»¶é²ç­–ç•¥ï¼‰**ï¼šé©åˆè‡ªå‹•è¿½è¹¤è¶¨å‹¢è®ŠåŒ–ï¼Œåˆ‡æ›è²·è³£ç‹€æ…‹ï¼Œä½†éœ€æ³¨æ„é˜²æ­¢é »ç¹å‡ºå…¥å ´
3. **Keep Buyingï¼ˆè²·é€²ç­–ç•¥ï¼‰**ï¼šé©åˆçœ‹å¤šæ•´é«”å¸‚å ´è¶¨å‹¢ï¼Œé¡˜æ„é•·æœŸæŒè‚¡ä¸¦å®šæœŸåŠ ç¢¼çš„æŠ•è³‡äºº

**æç¤ºï¼š** ä½¿ç”¨ `example.py` å¯å¿«é€Ÿç”Ÿæˆå›æ¸¬åœ–è¡¨ï¼Œç›´è§€æŸ¥çœ‹å„ç­–ç•¥åœ¨æ­·å²è³‡æ–™ä¸Šçš„è¡¨ç¾ã€‚


## é‡è¦æ”¹å‹•èªªæ˜

å°å°ˆæ¡ˆé€²è¡Œäº†ä»¥ä¸‹æ”¹é€²ï¼Œå¢å¼·ç©©å®šæ€§èˆ‡å¯ç¶­è­·æ€§ï¼š

### 1. **æ¨¡çµ„åŒ–ä¸»ç¨‹å¼å…¥å£**
- æ‰€æœ‰ä¸»è¦è…³æœ¬ï¼ˆ`init.py`, `update.py`, `recommend.py`, `example.py`ï¼‰å·²æ”¹ç‚ºæ¨™æº–çš„ `if __name__ == '__main__'` çµæ§‹ï¼Œé¿å…åŒ¯å…¥æ™‚ç”¢ç”Ÿå‰¯ä½œç”¨ã€‚
- æ ¸å¿ƒé‚è¼¯å·²å°è£æˆ `main()` å‡½å¼ï¼Œæ–¹ä¾¿è¢«å…¶ä»–ç¨‹å¼å¼•ç”¨æˆ–æ¸¬è©¦ã€‚

### 2. **çµ±ä¸€ CLI ä»‹é¢ï¼ˆmain.pyï¼‰**
- æ–°å¢ `main.py` ä½œç‚ºä¸»è¦å…¥å£ï¼Œæä¾›å››å€‹å­å‘½ä»¤ï¼š`download`, `update`, `recommend`, `example`ã€‚
- ä½¿ç”¨ `argparse` æ¨™æº–åŒ–æŒ‡ä»¤è™•ç†ï¼Œæ˜“æ–¼æœªä¾†æ“´å±•ï¼ˆä¾‹å¦‚åŠ åƒæ•¸ã€æ—¥èªŒè¼¸å‡ºç­‰ï¼‰ã€‚

### 3. **æ—¥èªŒç³»çµ±èˆ‡éŒ¯èª¤è™•ç†**
- æ‰€æœ‰è…³æœ¬å·²çµ±ä¸€ä½¿ç”¨ `logging` æ¨¡çµ„ï¼Œå–ä»£ç›´æ¥ `print()`ï¼Œä¾¿æ–¼æ§åˆ¶æ—¥èªŒè¼¸å‡ºç´šåˆ¥èˆ‡æ ¼å¼ã€‚
- `update.py` å¢å¼·äº† CSV æ¸…ç†èˆ‡æ—¥æœŸè½‰æ›çš„å¥å£¯æ€§ï¼ˆé¿å…æ™‚å€æ··äº‚ï¼‰ã€‚
- `recommend.py` æ”¹å–„äº†å°ç©ºè¨Šè™Ÿåˆ—è¡¨çš„è™•ç†ï¼Œé˜²æ­¢ IndexError ç•°å¸¸ã€‚

### 4. **ç­–ç•¥ä»‹é¢æ–‡ä»¶**
- æ–°å¢ `STRATEGY_INTERFACE.md`ï¼Œè©³ç´°åˆ—èˆ‰ä¸‰å€‹ç­–ç•¥æ¨¡çµ„çš„è¼¸å…¥æ¬„ä½éœ€æ±‚èˆ‡å›å‚³æ ¼å¼ã€‚
- å¹«åŠ©é–‹ç™¼è€…å¿«é€Ÿç†è§£å¦‚ä½•å°‡ç­–ç•¥ç•¶ä½œç¨ç«‹ library ä½¿ç”¨ã€‚

### 5. **ä»£ç¢¼å“è³ª**
- æ‰€æœ‰ä¸»ç¨‹å¼ç¾å·²éµå¾ª Python æœ€ä½³å¯¦è¸ï¼ˆæ¨¡çµ„å±¤ç´šç„¡å‰¯ä½œç”¨ï¼‰ã€‚
- å¢åŠ äº†éŒ¯èª¤æ—¥èªŒï¼ˆå¾ `print()` â†’ `logging`ï¼‰ï¼Œä¾¿æ–¼é™¤éŒ¯èˆ‡è¿½è¹¤ã€‚


å ±è¡¨å°‡è¼¸å‡ºè‡³ `stock_report.html`ï¼Œå¯ç”¨ç€è¦½å™¨é–‹å•ŸæŸ¥çœ‹ã€‚

- ç›´æ¥åœ¨ macOS ç”¨é è¨­ç€è¦½å™¨é–‹å•Ÿï¼š
````
open stock_report.html
````

https://voidful.github.io/tw_stocker/stock_report.html

